document.ajax_domain='https://lockify.com';document.ajax_permission_url='https://lockify.com/';var lockifyIndexGlobals={savePath:"/entry/save_express",maxQaAuthAttempts:"",maxMessageCharLength:"50000",dataInputInitialMsg:'',maxSecurityAnswers:5,minCharsEnableClose:6,maxGmailIds:5,maxEmailAddresses:5,maxTwitterIds:5,maxOpenIdIds:5,maxNativeIds:5,enable2wayUserIdCrypto:true,linkWarningLength:2083,otpMaxPhoneNumbers:4,uploadProgressMinKb:10,defaultFileReader:"html5",defaultFileWriter:"html5",maxFilesPerLink:5,maxFileKbPerLink:5120,addFirstFileText:"Select files ...",addAdditionalFileText:"Select files ..."};if(typeof lockifyGlobals=="undefined"){lockifyGlobals={UNIQUEURL_SUBPATH:"page"};}else{lockifyGlobals.UNIQUEURL_SUBPATH="page";}
lockifyGlobals.linkUrl="https://lockify.com/d";if(lockifyIndexGlobals.defaultFileReader!=="html5"){lockifyIndexGlobals.flashReaderFile="/site_media/flash/LocalFileReader.swf";lockifyIndexGlobals.minFlashReaderVersion="";lockifyIndexGlobals.autoloadFileReader=true;}
var AJAX_ERROR_PROTOCOL='https:';var AJAX_ERROR_HOST='lockify.com';lockifyAjax.sameOrigin=function(url){var aaa=document.createElement('a');var domain=document.ajax_domain;var urls=[domain,url];urls=$.map(urls,function(str,i){var mmm=str.match(/\/\/([^@]+@)/);if(mmm){str=str.replace(mmm[1],"");}
return str;});url=urls[1];aaa.href=urls[0];var host=aaa.host;var protocol=aaa.protocol;var srOrigin='//'+host;var origin=protocol+srOrigin;return(url==origin||url.slice(0,origin.length+1)==origin+'/')||(url==srOrigin||url.slice(0,srOrigin.length+1)==srOrigin+'/')||!(/^(\/\/|http:|https:).*/.test(url));};lockifyUtils.print=function(){top.frames[0].print();};lockifyUtils.longValueLimit=50;lockifyUtils.cookiesEnabled=function(){return true;};lockifyUtils.workaroundScrollBug=function(){return true;};lockifyUtils.updateHeaderHeight=function(){return true;}
$(document).ajaxSend(function(event,xhr,settings){if(settings.url.match('chrome-extension:')){settings.url=settings.url.replace(document.ajax_domain,'');}
xhr.setRequestHeader("CHROME_REFERER",window.location.origin+$("head > meta[name='webapp_equiv_path']").attr('content'));if(settings.type=="GET"){xhr.setRequestHeader("CHROME_ORIGIN",window.location.origin);}
if(lockify.account.gCSRFToken&&!lockifyAjax.safeMethod(settings.type)&&lockifyAjax.sameOrigin(settings.url)){xhr.setRequestHeader("X-CSRFToken",lockify.account.gCSRFToken);}});function resizeOnAuth(isAuthenticated){try{var win=window.top.chrome.app.window.current();var curWidth=top.document.body.offsetWidth;if(isAuthenticated){win.resizeTo(curWidth,550);}else{win.resizeTo(curWidth,0);}}catch(x){}}
function handleAuthentication(e,is_authenticated,use_chrome_ext,auth_json){lockify.account.gCSRFToken=auth_json.csrf_token;lockify.account.userInfo.set({'csrf_token':auth_json.csrf_token});if(auth_json.is_authenticated){var goodAuthUrls=["/popup.html","/links.html","/settings.html","/openssl.html","/tools.html","/decrypt.html","/info.html","/prngtest.html","/options.html","/team.html"];if((!lockifyUtils.onNewLinkPage())&&$.inArray(document.location.pathname,goodAuthUrls)==-1){top.frames[0].location.replace("popup.html");return false;}
$('.panel').hide();$('#id_username, #id_password').val('');$('span#username').text(auth_json.username);$('#data').focus();$('.user div').show();$('#openLogin').hide();$('#addFileDisabled').hide();$('#html5FileReader').show();$('.nonauthenticatedUserOnly').hide();if(lockifyUtils.onNewLinkPage()){lockify.index.hideAnonElemsAfterSignin();}}else{var goodGuestUrls=["/popupExpress.html","/openssl.html","/tools.html","/info.html","/decrypt.html","/prngtest.html","/options.html"];if($.inArray(document.location.pathname,goodGuestUrls)==-1){top.frames[0].location.replace("popupExpress.html");return false;}
$('.panel').hide();$('#id_username, #id_password').val('');$('span#username').text(auth_json.username);$('#data').focus();$('.nonauthenticatedUserOnly').show();}
$(window).resize();chrome.storage.local.get('firstRun',function(items){if(items.firstRun){if(typeof OpenRegisterDialogView!='undefined'){new OpenRegisterDialogView({el:$("#openRegisterDialog"),model:null});}}});}
$(document).ready(function(){$('#lf-header .icon-cancel').click(function(){var win=window.top.chrome.app.window.current();win.close();});$('.sign_out').click(function(){$.ajax({"dataType":'json',"type":'GET',"url":'https://lockify.com/accounts/logout/',"data":{},"success":function(data){top.frames[0].document.location.replace('popupExpress.html');},"error":function(data){var test=1;}});});if($.inArray(document.location.pathname,["/gateway.html"])>-1){$('body').addClass('d');return;}
if($.inArray(document.location.pathname,["/popup.html"])>-1||$.inArray(document.location.pathname,["/popupExpress.html"])>-1){$('body').addClass('e');}
$(document).bind('userAuthComplete',handleAuthentication);$('#tutVidLaunch').click(function(){var ddd=$('#tutVidDialog');var vp=new VideoPlayerView({el:ddd,srcUrl:"https://lockify.com/site_media/video/tutorial.webm"});});});