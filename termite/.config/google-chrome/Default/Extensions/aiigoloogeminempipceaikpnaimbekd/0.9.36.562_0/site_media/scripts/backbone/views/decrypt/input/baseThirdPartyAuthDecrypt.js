var BaseThirdPartyAuthDecryptView=BaseDecryptInputView.extend({initialize:function(){this.bind("authComplete",this.authComplete);},configureAuthLink:function(){throw"This function has not been overridden by its child instance.";},authComplete:function(querystring){if(querystring[0]!=="?"){querystring="?"+querystring;}
lockify.gateway.gOpenIDCallbackQuerystring=querystring;var is_allowed=false;var url;var oauth_verifier;if($('#twitter_auth_token').val()!==''){url="/entry/complete_external_auth";oauth_verifier=querystring.match(/oauth_verifier=([^&]*)/)[1];}else{url="/entry/get"+lockify.gateway.gOpenIDCallbackQuerystring;}
var self=this;$.ajax({type:"POST",url:url,data:"dh="+encodeURIComponent(lockify.gateway.dataHash)+"&twitter_auth_token="+encodeURIComponent($('#twitter_auth_token').val()||'')+"&openid_state="+encodeURIComponent(lockify.gateway.gOpenIDState||'')+"&oauth_verifier="+encodeURIComponent(oauth_verifier||''),dataType:"json",cache:false,success:function(ret){var json=ret;var errorElem=$('#authUis > div:visible').find('.error');is_allowed=json.is_allowed;if(is_allowed){$('#twitter_auth_token').val(json.token);$('#begin_twitter_auth, #begin_openid_auth').hide();$('#validGmailAccount').hide();$('#validOpenidAccount').hide();$('#getSecret').show().prop('disabled',false).removeClass('disabled');errorElem.addClass('authSuccess').html('<span aria-hidden="true" class="icon-checkmark icomoon-icon large"></span> Authentication<br/>Successful').css('display','block');$('.extLogoutWarning').show();$('.extLogoutWarning:visible').insertAfter($('#notYoursButtons'));$('.authUI_desc').hide();$('#authUi_email').hide();$('#authUi_lockifyUser').hide();$('#methodMetaTips').hide();$('#validTwitterAccount').hide();$('.status .meta').hide();$('.methodHelp').hide();}else{self.configureAuthLink();var errorJson=$.secureEvalJSON(json.error);if(errorElem&&errorJson.answerReply){var err=errorJson.answerReply||json.error;err=err.replace(/\{\{(.*)\}\}/g,function(all,match1){return $('#'+match1).val();});errorElem.html(new Showdown.converter().makeHtml(err)).show();}}}});}});