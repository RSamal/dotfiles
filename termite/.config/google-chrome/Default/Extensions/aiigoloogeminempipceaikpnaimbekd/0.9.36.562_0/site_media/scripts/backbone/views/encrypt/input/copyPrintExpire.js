var CopyPrintExpireView=Backbone.View.extend({defaults:{},events:{"change #easyCopy":"handleCopyChange","click #easyCopyDefault":"handleCopyDefaultClick","change #easyPrint":"handlePrintChange","click #easyPrintDefault":"handlePrintDefaultClick"},initialize:function(options){this.options=$.extend({},this.defaults,options||{});$(document).bind('formBoundToUserPrefs',this.updateElements);_.bindAll(this,['handleNewLinkUiPopulated']);$(document).bind('newLinkUiPopulated',this.handleNewLinkUiPopulated);$(document).bind('linkExpired',this.handleLinkExpiration);$(document).bind('migrateToSignedOn',_.bind(this.handleMigrateToSignedOn,this));_.bindAll(this,['reset']);$(document).bind('formReset',this.reset);},updateElements:function(){$('#easyCopy, #easyPrint').change();},handleCopyChange:function(){this.model.set({easyCopy:!$('#easyCopy').is(":checked")});if(this.options.saveOnChange){var pickedFields=_.pick(this.model.attributes,'dataHash','easyCopy','publicId');pickedFields.adminCredHash=this.model.get("cryptoAssets")["adminCredHash"];this.model.save(pickedFields,{patch:true,success:function(model,json){var callback;if(json.equalsDefault===false){callback=function(){};}else{lockifyUtils.cssFadeOut('#easyCopyDefault');}
if(json.success){lockifyUtils.displayUpdateResultDialog(lockifyGlobals.savedMsg,callback);if(typeof document.lockifyUserEntryDefaults!='undefined'&&document.lockifyUserEntryDefaults.get('enable_message_copying')==$('#easyCopy').is(':checked')){lockifyUtils.cssFadeIn('#easyCopyDefault');}}else{alert("Change Failed: "+json.Reason);}},error:null});}else{if(typeof document.lockifyUserEntryDefaults!='undefined'&&document.lockifyUserEntryDefaults.get('enable_message_copying')==$('#easyCopy').is(':checked')){lockifyUtils.cssFadeIn('#easyCopyDefault');}else{lockifyUtils.cssFadeOut('#easyCopyDefault');}}},handleCopyDefaultClick:function(event){var defaults=document.lockifyUserEntryDefaults;defaults.set('enable_message_copying',!$('#easyCopy').is(':checked'));defaults.save(_.pick(defaults.attributes,'enable_message_copying'),{patch:true,success:function(){lockifyUtils.cssFadeOut('#easyCopyDefault');lockifyUtils.displayUpdateResultDialog(lockifyGlobals.defaultSavedMsg);},error:function(){lockifyUtils.displayUpdateResultDialog('Something went wrong. Please try again.');}});},handlePrintChange:function(){this.model.set({easyPrint:!$('#easyPrint').is(":checked")});if(this.options.saveOnChange){var pickedFields=_.pick(this.model.attributes,'dataHash','easyPrint','publicId');pickedFields.adminCredHash=this.model.get("cryptoAssets")["adminCredHash"];this.model.save(pickedFields,{patch:true,success:function(model,json){var callback;if(json.equalsDefault===false){callback=function(){};}else{lockifyUtils.cssFadeOut('#easyPrintDefault');}
if(json.success){lockifyUtils.displayUpdateResultDialog(lockifyGlobals.savedMsg,callback);if(typeof document.lockifyUserEntryDefaults!='undefined'&&document.lockifyUserEntryDefaults.get('enable_message_printing')==$('#easyPrint').is(':checked')){lockifyUtils.cssFadeIn('#easyPrintDefault');}}else{alert("Change Failed: "+json.Reason);}},error:null});}else{if(typeof document.lockifyUserEntryDefaults!='undefined'&&document.lockifyUserEntryDefaults.get('enable_message_printing')==$('#easyPrint').is(':checked')){lockifyUtils.cssFadeIn('#easyPrintDefault');}else{lockifyUtils.cssFadeOut('#easyPrintDefault');}}},handlePrintDefaultClick:function(event){var defaults=document.lockifyUserEntryDefaults;defaults.set('enable_message_printing',!$('#easyPrint').is(':checked'));defaults.save(_.pick(defaults.attributes,'enable_message_printing'),{patch:true,success:function(){lockifyUtils.cssFadeOut('#easyPrintDefault');lockifyUtils.displayUpdateResultDialog(lockifyGlobals.savedMsg);},error:function(){lockifyUtils.displayUpdateResultDialog('Something went wrong. Please try again.');}});},handleNewLinkUiPopulated:function(){this.options.saveOnChange=true;},handleLinkExpiration:function(){$("#viewerOptionsContainer").hide();},handleMigrateToSignedOn:function(){if(this.model.get('easyCopy')!=document.lockifyUserEntryDefaults.get('enable_message_copying')){lockifyUtils.cssFadeIn('#easyCopyDefault');}
if(this.model.get('easyPrint')!=document.lockifyUserEntryDefaults.get('enable_message_printing')){lockifyUtils.cssFadeIn('#easyPrintDefault');}},reset:function(){}});