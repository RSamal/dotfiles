var RegistrationActivateView=Backbone.View.extend({initialize:function(){if($('#id_new_password1').length){if(typeof $.fn.complexityGauge=='function'){$('#id_new_password1').complexityGauge();}
$('#id_new_password2').matchTest({compareInputControl:$('#id_new_password1'),msgAfterSelector:'label[for="id_new_password2"]'});}
var uidb36=lockifyUtils.getUrlParam('u');var token=lockifyUtils.getUrlParam('t');if(!uidb36||!token){$('#missingQueryStringUi').show();return;}
var self=this;$(document).bind('userAuthComplete',function(){data='u='+uidb36+'&t='+token;lockifyAjax.ajaxJSONSafe('/account/token_validate_json',data,function(json){if(json.emailAlreadyClaimed){$('#emailClaimedUi').show();}else if(json.validlink===true){var timezone='GMT';if(json.timezone){timezone=json.timezone;}
if(self.$('.timezoneViewWrapper').length){self.tzoneDropDown=new TimezoneSelectView({el:$('.timezoneViewWrapper'),model:new Backbone.Model({timezone:timezone})});}
$('#uidb36').val(uidb36);$('#token').val(token);$('#validLinkUi').show();$('#id_new_password1').focus();}else{if(json.tokenExpired){$('#invalidLinkUi .expired').show();$('#invalidLinkUi .corrupt').hide();}else{$('#invalidLinkUi .expired').hide();$('#invalidLinkUi .corrupt').show();}
$('#invalidLinkUi').show();}},function(json){$('#invalidLinkUi').show();});});$(document).on("maskToggled","#id_new_password2",function(ev,newInput){newInput.matchTest({compareInputControl:$('#id_new_password1'),msgAfterSelector:'label[for="id_new_password2"]'});});$('.toggleMaskIcon').toggleMask({"inputs":$('#id_new_password1, #id_new_password2')});},events:{"submit #newReset_form3":"handleFormSubmit"},handleFormSubmit:function(e){$('#newReset_form3 .error').hide();$('#newReset_form3').find('input').removeClass('validationError');$(e.currentTarget).append('<input type="hidden" name="registerTzoneSelect" value="'+this.tzoneDropDown.val()+'">');lockifyAjax.ajaxJSONSafeForm('/password/reset/confirm_json/',$(e.currentTarget),function(json){window.location.replace('/e');},function(json){if(json.errors){$('#newReset_form3 .button').trigger('deanimate');$.each(json.errors,function(name,val){$('#'+name+"_errors").text(val.join(' ')).show();$('#id_'+name).addClass('validationError');});}});return false;}});