var BaseAuthGmailDecryptView=BaseThirdPartyAuthDecryptView.extend({initialize:function(options){this.options=$.extend({},this.defaults,options);$('.openid_service_name').text(this.options.json.openid_service_name);$('#openid_url').val(this.options.json.openid_service_url);$('#authUi_openid').show();$('#openidHeader').show();$('#nativeHeader').hide();$('#emailHeader').hide();$('#emailHeader-action').hide();$('#openidMetaTips').show();$('#back_gmail_button').hide();if($('#emailHeader').is(':visible')){$('#emailHeader').hide();}
if($('#emailHeader-action').is(':visible')){$('#emailHeader-action').hide();}
BaseAuthGmailDecryptView.__super__.finishInstructionText(this.options.json,this.options.authkey,$('#validOpenidAccount'));$('#authUis').addClass('auth_type_openid');this.bind('configureOpenIDAuthLink',this.configureOpenIDLink);this.bind("authComplete",this.authComplete);BaseAuthGmailDecryptView.__super__.configureAuthLink=this.configureOpenIDAuthLink;BaseAuthGmailDecryptView.__super__.setLinkUrl=this.setLinkUrl;if(!$('#integratedemail').val()&&$('#validOpenidAccount').children().hasClass('multipleValueIds')){$('.status .multiple').show();$('.status .single').hide();}else{$('.status .single').show();$('.status .multiple').hide();}},events:{"click #gmailBackButton":"handleBackClick"},configureOpenIDLink:function(){$('.error').text('');$('#begin_openid_auth').waitButton().unbind('click').click(function(e){if($(this).prop('disabled')){e.preventDefault();return false;}
$('.error').text('');return true;});$('#getSecret').hide();$('#getSecret').before($('#begin_openid_auth'));this.configureOpenIDAuthLink();$('#getSecret').addClass('disabled').prop('disabled',true);},configureOpenIDAuthLink:function(){var ajaxURL=$('#openid_ajax_url').val()+'?dh='+encodeURIComponent(lockify.gateway.dataHash)+'&openid_url='+encodeURIComponent($('#openid_url').val());var self=this;$.ajax({type:"GET",url:ajaxURL,data:"",dataType:"json",cache:false,success:function(data){if(!data){alert('Error: did not receive a valid response from the server. Please try again later.');return;}
lockify.gateway.gOpenIDState=data['state'];if(data['message']){$('.error').text(data['message']);}else if(data['location']){self.setLinkUrl(data['location']);$('#begin_openid_auth').prop('disabled',false);$('#begin_openid_auth').trigger('deanimate');}},error:function(XMLHttpRequest,textStatus,errorThrown){$('.error').text(XMLHttpRequest.responseText);}});},setLinkUrl:function(href){throw"This function has not been overridden by its child instance.";},authComplete:function(querystring){BaseAuthGmailDecryptView.__super__.authComplete(querystring);},handleBackClick:function(){$('#authUi_openid').hide();$('#notYoursButtons').hide();$('#authUi_integratedemail').show();$('#openid_ajax_url').before($('#begin_openid_auth'));$('#authUi_openid .multipleValueIds').remove();$('#emailMetaTips').show();$('.error').hide();}});