var MemberEmailModel=Backbone.Model.extend({url:function(){return"/sme/organization/"+this.orgModel.get('id')+"/email/template/"+this.get('id')+"/";},mutators:{fsubject:function(){return this.get('subject').replace('{{ organization_name }}',this.orgModel.get('organization').name);},fbody:function(){if(!this.get('body')){return'';}
return this.get('body').replace('{{ first_name }} {{ last_name }}',this.userModel.get('fullName'));}},saveMemberEmail:function(){var pickedFields=_.pick(this.attributes,'fbody');pickedFields['subject']=this.get('fsubject');pickedFields['body']=this.get('smeMessage');pickedFields['userId']=this.userModel.get('id');return this.save(pickedFields).then(_.bind(this.handleSaveSuccess,this)).fail(_.bind(this.handleSaveFailure,this));},handleSaveSuccess:function(data){console.log(data.success);if(data.success){this.userModel.set('status','invited');this.userModel.trigger('change:statusDisplay');this.trigger('inviteSaveSuccess');}else{this.handleSaveFailure(data);}},handleSaveFailure:function(data){this.trigger('inviteSaveFailure',data);}});