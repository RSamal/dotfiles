/*
 * Lockify Account Settings
 * Copyright 2010 Lockify Inc. All Rights Reserved.
 * License:
 * Account settings page for managing various options for the
 * account
*/
$(document).ready(function(){$('div.global-border').each(function(){$(this).find('div.hr:last').remove();});$("#notaccordion").addClass("ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find("h3").addClass("ui-accordion-header ui-helper-reset ui-state-default").hover(function(){$(this).toggleClass("ui-state-hover");}).prepend('<span aria-hidden="true" class="icon-plus icomoon-icon"></span>').click(function(){if($('h3').hasClass('ui-state-active')){window.location.hash='multiple';}else{window.location.hash=$(this).children('a').text().replace(/\s+/g,'');}
$(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default").find("> .icomoon-icon").toggleClass("icon-plus icon-minus").end().next().toggleClass("ui-accordion-content-active").slideToggle(function(){if($('h3').hasClass('ui-state-active')){$("#acaBtn").addClass("enabled").removeClass("disabled");}else{$("#aoaBtn").addClass("enabled").removeClass("disabled");$("#acaBtn").removeClass("enabled").addClass("disabled");}});return false;}).next().addClass("ui-accordion-content  ui-helper-reset ui-widget-content ui-corner-bottom").hide();$("#aoaBtn").click(function(){if($(this).hasClass('enabled')){$("h3.ui-state-default").click();$(this).addClass("disabled").removeClass("enabled").removeClass("fillLightBlue");$("#acaBtn").addClass("enabled").removeClass("disabled").addClass("fillLightBlue");}});$("#acaBtn").click(function(){if($(this).hasClass('enabled')){$("h3.ui-state-active").click();$(this).addClass("disabled").removeClass("enabled").removeClass("fillLightBlue");$("#aoaBtn").addClass("enabled").removeClass("disabled").addClass("fillLightBlue");}});$(document).on("mouseover","h3.ui-accordion-header",function(){$(this).next('.ui-accordion-content').addClass('ui-state-hover');}).on("mouseout","h3.ui-accordion-header",function(){$(this).next('.ui-accordion-content').removeClass('ui-state-hover');});$('#delPrefsBtn').click(function(){lockifyAjax.ajaxJSONSafe('/account/preferences/delete',null,function(json){window.location.reload();},null);});var populatePreferences=function(callback){var secondaryEmailsView;var secondaryEmailCollection=new SecondaryEmailCollection();secondaryEmailCollection.fetch({success:function(collection,response){secondaryEmailsView=new SecondaryEmailsView({el:$('#secondaryEmails'),collection:collection});}});var generalModel=new GeneralSettingsModel();generalModel.fetch({success:function(model,response){var generalView=new GeneralSettingsView({el:$('#accountSettingsContent'),model:generalModel,secondaryEmailsView:secondaryEmailsView});}});if(typeof OrganizationCollection=="function"&&lockify.account.userInfo.get('sme_org_count')>0){var orgsColl=new OrganizationCollection();orgsColl.fetch({success:function(model,response){var orgsView=new OrganizationsView({el:$('#smeOrgContainer'),collection:orgsColl});}});}
var entryDefaultsModel=new EntryDefaultsModel();entryDefaultsModel.fetch({success:function(model,response){var entryDefaultsView=new EntryDefaultsView({el:$('#lockificationsDefaultsTab').next('div'),model:model});}});var uniqueurlView=new UniqueurlSettingsView({el:$('#uniqueurlContainer'),model:generalModel});};$(document).bind('userAuthComplete',function(e,is_authenticated,use_chrome_ext,json){if(is_authenticated&&typeof json.anonymous_encrypt_path=="string"){new GuestEncLinkView({el:$(),model:null,path:json['anonymous_encrypt_path']});}
populatePreferences(function(){});});$(document).bind('userAuthComplete',function(){var mailingListModel=new MailingListModel();mailingListModel.fetch({success:function(model,response){if(typeof MailingListView=='function'){var mailList=new MailingListView({el:$('#mailingLists'),model:mailingListModel,response:response});}}});});if(window.location.hash=='#Accountsettings'){$("#accountSettingsTab").click();}else if(window.location.hash=='#LockifyLinkDefaults'){$("#lockificationsDefaultsTab").click();}else if(window.location.hash=='#HandlingAuthInfo'){$("#HandleAuthTab").click();}else if(window.location.hash=='#YourLockifyPage'){$("#lockifyMeTab").click();}else if(window.location.hash=='#Inviteafriend'){$("#inviteAFriendTab").click();}else if(window.location.hash=='#API'){$("#apiTab").click();}else if(window.location.hash=='#Alerts'){$("#alertsTab").click();}else if(window.location.hash=='#Mailinglist'){$("#mailingListTab").click();}});