var EmailFormView=Backbone.View.extend({defaults:{},events:{"change textarea":"handleSmeMessageChange"},initialize:function(options){this.options=$.extend({},this.defaults,options||{});_.bindAll(this,'handleTemplateUpdate','handleSendBtnClick');this.model.on("change:body",this.handleTemplateUpdate);this.$('button').unbind('click').waitButton();},render:function(){var addStr;if(this.model.userModel.get("first_name")!==''&&this.model.userModel.get("last_name")!==''){addStr=this.model.userModel.get("first_name")+" "+this.model.userModel.get("last_name")+" <"+this.model.userModel.get("email")+">";}else{addStr=this.model.userModel.get("email");}
this.$('.to').text(addStr);this.$('input[type="text"]').val(this.model.get('fsubject'));this.$('#smeEmailSubject').text(this.model.get('fsubject'));this.$('textarea').val(this.model.get('fbody'));this.$('button').bind('click',this.handleSendBtnClick);return this;},handleTemplateUpdate:function(){return this.render();},handleSendBtnClick:function(e){this.model.saveMemberEmail();},handleSmeMessageChange:function(e){this.model.set('smeMessage',$(e.target).val());}});