var InviteRequestView=Backbone.View.extend({events:{'focus input.betaListEmail':'handleInputFocus','blur input.betaListEmail':'handleInputBlur'},defaults:{ignoreEmpty:false},initialize:function(options){this.options=$.extend({},this.defaults,options||{});var self=this;$("#betaListSubscribeDialog").bind('dialogclose',function(){self.$('.successHide').show();self.$('.response').hide();self.$('.betaListSubscribeForm .smallFont').show();if(window.location.hash=="#reserve_spot"){window.location.hash="";}});_.bindAll(this,['handleSubmit']);this.$('.betaListBtn').click(this.handleSubmit);this.$('.betaListBtn').waitButton();},handleInputFocus:function(event){},handleInputBlur:function(event){},handleSubmit:function(event){params={'email':$('.betaListEmail:visible').val(),'referrer_sub':document.location.pathname,'referrer_client':lockifyGlobals.client_type};var input=this.$('.betaListEmail');var val=input.val();if(this.options.ignoreEmpty&&val.length==0){$(this.el).trigger("submitComplete");return false;}else{var self=this;$.post('/beta_list/subscribe',$.param(params),function(json){if(json.result=='success'){self.$('.successHide').hide();self.$('.betaListEmail').val('');self.$('.subscribe-success-response').show();self.$('.subscribe-error-response').hide();self.$('.betaListSubscribeForm .smallFont').hide();self.$('.subscriber-email').text(val);self.$('.betaListEmail').removeClass('validationError');self.$('.subscribe-responses .betaListAddEmail').click(function(){self.$('.subscribe-success-response').hide();self.$('.successHide').show();});$(self.el).trigger("submitComplete");$(self.el).trigger("submitSent");}else{self.$('.subscribe-error-response').text(json.result).show();self.$('.subscribe-success-response').hide();self.$('.betaListEmail').addClass('validationError');}
self.$('.betaListBtn').trigger('deanimate');},'json');}
return false;}});