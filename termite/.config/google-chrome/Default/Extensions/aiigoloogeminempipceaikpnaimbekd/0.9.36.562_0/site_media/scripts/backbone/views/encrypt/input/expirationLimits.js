var ExpirationLimitsView=Backbone.View.extend({events:{"click #expireUIDefault":"handleSaveDefaultsChange","click .hideExpireOptions":"handleShowExpireOptions","click .defaultBandText":"handleShowExpireOptions"},viewsAndTime:null,initialize:function(options){this.viewsAndTime=new ViewsAndTimeView({el:$('#viewingsContainer_outer').parent(),model:options.model});if(typeof EarlyExpireView=='function'){this.earlyExpire=new EarlyExpireView({el:$('#expireEarlyOption'),model:lockify.index.entry,saveOnChange:false});}
_.bindAll(this,['handleChildChange']);this.viewsAndTime.bind('change',this.handleChildChange);this.earlyExpire.bind('change',this.handleChildChange);_.bindAll(this,['reset']);$(document).bind('formReset',this.reset);},handleChildChange:function(event){if(this.model.expirationValuesMatchDefaults(document.lockifyUserEntryDefaults)){lockifyUtils.cssFadeOut('#defaultLinkContainer');}else{lockifyUtils.cssFadeIn('#defaultLinkContainer');}
$("#bandDefaultTime").text($("#timerSelect").children('.selected').text());$("#bandDefaultView").text($("#viewingsSelect").children('.selected').text());},handleSaveDefaultsChange:function(event){var defaults=document.lockifyUserEntryDefaults;defaults.set({"maxViews":this.viewsAndTime.viewingsDropDown.val(),"lifeMinutes":this.viewsAndTime.timespanDropDown.val(),"allowManualExpiration":$('#allowExpire').is(':checked')});callback=function(){};document.lockifyUserEntryDefaults.save(_.pick(defaults.attributes,'maxViews','lifeMinutes','allowManualExpiration'),{patch:true,success:function(){lockifyUtils.cssFadeOut('#defaultLinkContainer');lockifyUtils.displayUpdateResultDialog(lockifyGlobals.defaultSavedMsg);}});},handleShowExpireOptions:function(){$('#expireOptions').slideToggle();$('.defaultBandText').toggleClass('defaultHide');$('.editBandText').toggleClass('defaultHide');$('.hideExpireOptions').toggleClass('defaultHide');},reset:function(){$('#expireDefaults').show();$('#expireChangeOptions').hide();}});