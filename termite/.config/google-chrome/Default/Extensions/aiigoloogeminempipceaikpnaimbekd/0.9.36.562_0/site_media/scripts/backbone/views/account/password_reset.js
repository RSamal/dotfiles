var PasswordResetView=Backbone.View.extend({defaults:{},events:{},initialize:function(){$('#topNavbar').hide();if(typeof $.fn.complexityGauge==="function"){$('#id_new_password1').complexityGauge();}
$('#id_new_password1').focus();var uidb36=lockifyUtils.getUrlParam('u');var token=lockifyUtils.getUrlParam('t');if(!uidb36||!token){$('#missingQueryStringUi').show();return;}
$(document).bind('userAuthComplete',function(){data='u='+uidb36+'&t='+token;lockifyAjax.ajaxJSONSafe('/account/token_validate_json',data,function(json){if(json.validlink==true){$('#uidb36').val(uidb36);$('#token').val(token);$('#validLinkUi').show();}else{if(json.tokenExpired){$('#invalidLinkUi .expired').show();$('#invalidLinkUi .corrupt').hide();}else{$('#invalidLinkUi .expired').hide();$('#invalidLinkUi .corrupt').show();}
$('#invalidLinkUi').show();}},function(json){$('#invalidLinkUi').show();});});$('#newReset_form2').submit(function(){$('#newReset_form2').find('input').removeClass('validationError');lockifyAjax.ajaxJSONSafeForm('/password/reset/confirm_json/',$(this),function(json){$('#validLinkUi').hide();if(json.redirect){$('#completeUi a').attr('href',json.redirect);}
$('#completeUi').show();},function(json){this.$('.button').trigger('deanimate');$('#newReset_form2 .error').hide();if(json.errors){$.each(json.errors,function(name,val){$('#'+name+"_errors").text(val.join(' ')).show();$('#id_'+name).addClass('validationError');});}});return false;});}});