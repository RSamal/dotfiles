var UtilityLinksView=Backbone.View.extend({defaults:{},events:{'click .utilBtn':'handleHeaderClick','click .expressSignIn':'handleExpressSignIn','click .expressRegister':'handleExpressRegisterClick'},initialize:function(){$(document).trigger('utilLinksInit');},handleHeaderClick:function(e){var openSignInDialog=function(){$('#expressUtilityPanels').dialog($.extend({},dialogOptions,{open:function(event,ui){$('#firstLoginScreen').removeClass('defaultHide');$('#secondLoginScreen').addClass('defaultHide');$('#loginButton').trigger('deanimate');}}));};if($('body').hasClass('express')){if(lockifyUtils.onNewLinkPage()){openSignInDialog();}else{if($('#data').val().length||$('#addedDocsDiv').is(':visible')||$('.authOptionPanel').find('input').val().length){$('#signInWarn').dialog($.extend({},dialogOptions,{open:function(event,ui){$('.continueSignIn').click(function(){openSignInDialog();});}}));}else{openSignInDialog();}}}else{openSignInDialog();}
$('#expressUtilityPanels').one("dialogclose",function(event,ui){if($.inArray(window.location.hash,["#reset_password","#resend_activation_link","#sign_in","#register"])>-1){window.location.hash="";}});},handleExpressSignIn:function(e){if(!lockifyUtils.getUrlParam('next')&&$('body').is('.express, .login')){window.location.hash='#sign_in';}
if(lockifyUtils.onNewLinkPage()){$('#login_form .claimLinkCb').prop('checked',true);$('#login_form .claimLink').show();}
$('#signInUI').show();$('#forgotPwordUI').hide();$('#loginForgot').show();$('#learnMorePanel').hide();$('#registerPanel').hide();$('#signInPanel').show();$('#loginExtraInfo').show();$('.dynamicText').text($('.dynamicText').data('signin'));if(!lockifyUtils.isMobile){this.handleInputFocus();}},handleExpressRegisterClick:function(e){if($('body').is('.express, .login')){window.location.hash="#register";}
$('#learnMorePanel').hide();$('#signInPanel').hide();$('#registerPanel').show();$('#loginExtraInfo').show();$('.dialogHeader .dynamicText').html($('.dynamicText').data('register'));if(lockifyUtils.onNewLinkPage()){$('#registration_form .claimLinkCb').prop('checked',true);$('#registration_form .claimLink').show();$('#registration_form').parent().children('.claimLink').show();$('#registerButton').click(function(event){});}
if(!lockifyUtils.isMobile){this.handleInputFocus();}},handleExpressForgotClick:function(e){if(window.location.hash=="#resend_activation_link"){$('.dynamicText').text($('.dynamicText').data('activationlink'));$('#expressUtilityPanels').find('.reset').hide();$('#expressUtilityPanels').find('.resend').show();}else{if($('body').is('.express, .login')){window.location.hash="#reset_password";}
$('.dynamicText').text($('.dynamicText').data('passwordreset'));$('#expressUtilityPanels').find('.resend').hide();$('#expressUtilityPanels').find('.reset').show();}
$('#signInPanel').show();$('#forgotPwordUI').show();$('#reset_password_form').show();$('#resetPasswordSubmitted').hide();$('#signInUI').hide();$('#loginExtraInfo').hide();if(!lockifyUtils.isMobile){this.handleInputFocus();}},handleInputFocus:function(){setTimeout(function(){$('#expressUtilityPanels').find('input[type=text],input[type=email],input[type=password]').filter(':visible:first').focus();},500);},reset:function(){}});