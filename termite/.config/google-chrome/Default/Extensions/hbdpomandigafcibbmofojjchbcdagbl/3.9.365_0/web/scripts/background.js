function handlePageChange(e){var t=chrome.extension.getURL("");e.url.substr(0,t.length)===t&&-1!==e.url.indexOf(TD.bg.MAIN_APP_PAGE_LOCATION)?theTab?e.id!=theTab.id&&(console.log("Duplicate TweetDeck page"),chrome.tabs.remove(e.id),TD.bg.utils.showTDTab()):(console.log("TweetDeck page created"),theTab=e):theTab&&e.id==theTab.id&&(console.log("User has navigated away"),handlePageDeath(e.id))}function handlePageDeath(e){theTab&&e==theTab.id&&(console.log("TweetDeck page closed"),theTab=null)}function handleOnInstalled(e){console.log("TweetDeck app installed");var t=localStorage.getItem(KEY_CHROME_RESTORE_TAB);if(localStorage.removeItem(KEY_CHROME_RESTORE_TAB),"update"===e.reason&&t){var n=JSON.parse(t);chrome.tabs.create({windowId:n.windowId,index:n.index,url:n.url,active:n.active,pinned:n.pinned})}}TD={bg:{},util:{}},TD.util.isChromeApp=function(){return!0},TD.bg.init=function(){TD.bg.contextMenu.init(),TD.bg.MAIN_APP_PAGE_LOCATION="web/templates/default.html"};var KEY_CHROME_RESTORE_TAB="chromeRestoreTab",theTab=null;chrome.tabs.onCreated.addListener(handlePageChange),chrome.tabs.onUpdated.addListener(function(e,t,n){t.url&&handlePageChange(n)}),chrome.tabs.onRemoved.addListener(handlePageDeath),chrome.runtime.onInstalled.addListener(handleOnInstalled),TD.buildID="LOCAL",TD.buildIDShort="LOCAL",TD.buildTime=Date.now(),TD.version="10.101.0",TD.config={debug_level:0,debug_checks:!0,debug_menu:!0,scribe_debug_level:1,flight_debug:!1,api_root:"https://tdapi-staging.smf1.twitter.com",td_create_key:"WRaMQNHU2Jy51bhFEL3C",td_create_secret:"MiLkmD1t1xlZqKoLLY8ScxX5gwpOQsjBopZcV4KLcuo=",sync_name:"blackbird",client_name:"blackbird",twitter_api_base:"https://api.twitter.com",twitter_api_version:"1.1",internal_build:!0,custom_timelines:!0,touchdeck:!0,force_touchdeck:!1,force_enable_migration:!1,disable_metrics_error:!1,disable_metrics_events:!1,i18n_test:!1,i18n_test_length_ratio:.65,i18n_test_padding_char:"d",decider_overlay:{}},function(e,t){"function"==typeof define&&define.amd?define([],t):e.TD.util.i18n=t()}(this,function(){var e,t={};return t.getMessage=function(e){if("undefined"==typeof TD_locale_messages)return void 0;var t=TD_locale_messages[e];return t&&t.message?t.message:void 0},t.getLocale=function(){return e?e:(TD.util.isChromeApp()&&(e=t.getMessage("@@ui_locale")),e)},t}),function(e,t){"function"==typeof define&&define.amd?define(["scripts/utils/i18n"],t):e.TD.i=t(TD.util.i18n)}(this,function(e){var t=/[^A-Za-z0-9_]/g,n={};return function(i,a,o){var r,c,l,s=TD.config.i18n_test_length_ratio||.2,d=TD.config.i18n_test_padding_char||"d";return"string"==typeof i&&(i={text:i}),"en_US"===e.getLocale()?c=i.text:(r=n[i.text],void 0===r&&(r=i.text.replace(t,""),n[i.text]=r),c=e.getMessage(r)||i.text),o||(c=TD.ui.template.toHtml(c,a)),TD.config.i18n_test&&(l=Math.round(c.length*s),c+=Array(l+1).join(d)),c}}),TD.bg.utils={},TD.bg.utils.getActiveTabWindow=function(){for(var e,t=chrome.extension.getViews(),n=0;n<t.length;n++)if(e=t[n],e.location.href==theTab.url)return e},TD.bg.utils.showTDTab=function(){if(theTab){var e=function(e){theTab=e,chrome.windows.get(e.windowId,t)},t=function(e){e.focused||chrome.windows.update(e.id,{focused:!0})};chrome.tabs.get(theTab.id,e),chrome.tabs.update(theTab.id,{selected:!0})}},TD.bg.utils.focusOrOpenTDTab=function(e){var t=function(){var t=TD.bg.utils.getActiveTabWindow(),n=function(){return t.TD&&t.TD.ready?void e(t):void setTimeout(n,500)};n()};theTab&&theTab.id?(TD.bg.utils.showTDTab(),t()):chrome.tabs.create({url:TD.bg.MAIN_APP_PAGE_LOCATION},function(){setTimeout(function(){t()},100)})},TD.bg.contextMenu=function(){var e={},t=chrome.contextMenus,n=(chrome.i18n.getMessage,function(e,t){var n;e.linkUrl?n=e.linkUrl:(t&&t.title&&(n=t.title,n.length>100&&(n=n.substr(0,100)+"â€¦"),n+=" "),n+=e.pageUrl),TD.bg.utils.focusOrOpenTDTab(function(e){e.jQuery(e.document).trigger("uiComposeTweet",{text:n.trim()+" "})})});return e.init=function(){t.create({title:TD.i("Share page with TweetDeck",null,!0),onclick:n}),t.create({title:TD.i("Share link with TweetDeck",null,!0),onclick:n,contexts:["link"]})},e}(),TD.bg.init();